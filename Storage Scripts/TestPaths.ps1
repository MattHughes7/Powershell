#region Folders
$instances = @(
"AAS",
"Accenture_Prod",
"ASD20",
"ASD20_JP",
"BJU",
"Broward",
"CENCOL",
"CSULB",
"D2L_Community",
"Gwinnett",
"HACC",
"LCC",
"LU",
"MCL",
"Mercy",
"MWSU",
"NAU",
"NDU",
"NJVS",
"OOL_GUELPH",
"OUHSC",
"PCCD",
"PJE",
"Portland_prod",
"PSU",
"Radford_Prod",
"SAIT",
"sharedM",
"Surrey",
"TAMUK",
"UCB",
"USG",
"Walsh",
"EFMOOC",
"GSU",
"IALC",
"IECC",
"IHM",
"JCCC",
"LCCC",
"Mac",
"OUPScorm",
"OUPUAT",
"PASSHE",
"PCT",
"Regis",
"SharedJ",
"sharedL",
"TUI",
"UWL_MOOC",
"WLU",
"uWaterloo",
"ADLC",
"BCOnline",
"CoK",
"EFT",
"EGTC",
"LCL",
"MACU",
"Marymount",
"McG",
"NMHU",
"Noodle",
"OCC",
"PIMA",
"sharedB",
"sharedG",
"sharedK",
"Sheridan",
"SIU",
"UAF",
"UNB",
"USGTraining",
"UWinnipeg",
"WHRO",
"WHRO_State",
"WIU",
"4CD",
"ACL",
"ADLCTEST",
"AOE_Prod",
"CBC",
"CICA",
"Community",
"Conestoga",
"DeSales",
"Durham",
"EIU",
"eLOTestDemo",
"FDLC",
"GADOE",
"GRU",
"HCL",
"HISD",
"hmhprod",
"IAL",
"iLearnNYC",
"InfiLaw",
"KishOnline",
"KNAER",
"LakeheadU",
"LANGARA",
"MarcJacobs",
"NEIU",
"NLU",
"NWFSC",
"OntarioSmartServe",
"ORU",
"OUP",
"Parkland",
"PearsonProd",
"pg",
"PilotProject01_LMS",
"RCL",
"Sandbox_C",
"SANOMAPRO",
"Sault",
"sharedA",
"sharedD",
"sharedF",
"sharedH",
"sharedP",
"Showcase_C",
"UCO",
"UManitoba",
"UMUC",
"UTEC",
"VIU",
"4CDTest",
"Accenture_Test",
"AOE_Test",
"ASD20Test",
"BCOnlineTest",
"BJUTest",
"CBCTest",
"CENCOLAPM",
"CENCOLTEST",
"CSULBTest",
"D2L_Community_Test",
"DurhamStaging",
"DurhamTest",
"EFMOOCQA",
"EFTDev",
"EGTC_TEST",
"EIUTest",
"FDLCTest",
"GADOETest",
"GSUDev",
"GSUTest",
"GwinnettTest",
"HACCTest",
"HBS_Sandbox",
"iLearnNYCStaging",
"iLearnNYCTest",
"InfiLawTest",
"LakeheadUTest",
"LangaraTest",
"LCCTest",
"LCLTest",
"LUTest",
"MacTest",
"McGTest",
"MCLTest",
"Mercy_Test",
"MWSUTest",
"NAUTEST",
"NEIUTest",
"NJVS_Test",
"NMHUTest",
"NoodleTest",
"NWFSCTest",
"OCCTest",
"ool_guelphtest",
"ORUTest",
"OUHSCTest",
"OUPDev",
"OUPTest",
"ParklandTest",
"PASSHETest",
"PCCDTest",
"PearsonDev",
"PearsonDev2",
"PearsonQA",
"pgtest",
"PIMATest",
"PJETest",
"PortlandTest",
"Radford_Test",
"Regis_Test",
"SAITTest",
"Sandbox_B_Test",
"Sandbox_S_Test",
"SanomaProTest",
"sharedBt",
"sharedDt",
"SheridanDev",
"SheridanQA",
"SIUTest",
"SouthCarolinaDev",
"TAMUKTest",
"TV",
"UCBDev",
"UCBTest",
"UCOTest",
"UManitobaTest",
"UMUCDev",
"UNBTest",
"UTECTest",
"uwaterlooDev",
"uWaterlooTest",
"UWinnipegTest",
"VIUTest",
"WalshTest",
"WHRO_State_Test",
"WHRO_Test",
"WIUTest",
"WLUTest"
)

$folders = @(
"\\fs-aas\aas\files\",
"\\fsc07\Accenture_Prod\files\",
"\\FSC09\ASD20\files\",
"\\FSC09\ASD20\files\",
"\\FSC08\BJU\files\",
"\\FSC08\Broward\files\",
"\\FSC08\CENCOL\files\",
"\\fsc07\CSULB\files\",
"\\fsc07\D2L_Community\files\",
"\\FSC07\Gwinnett\files\",
"\\FSC08\HACC\files\",
"\\FSC08\LCC\files\",
"\\fsc07\lu\files\",
"\\fsc07\MCL\files\",
"\\fsc07\Mercy\files\",
"\\fsc07\MWSU\files\",
"\\fsc07\NAU\files\",
"\\fsc07\NDU\files\",
"\\fsc09\NJVS\files\",
"\\FSC07\OOL_GUELPH\files\",
"\\fsc07\OUHSC\files\",
"\\fsc07\PCCD\files\",
"\\fsc07\PJE\files\",
"\\fsc07\Portland_prod\files\",
"\\FSC07\PSU\files\",
"\\fsc07\Radford_Prod\files\",
"\\FSC08\SAIT\files\",
"\\fs-sharedm\SharedM\files\",
"\\fsc07\Surrey\files\",
"\\FSC07\TAMUK\files\",
"\\FSC07\UCB\files\",
"\\FSC09\USG\files\",
"\\FSC07\Walsh\files\",
"\\fsc08\EFMOOC\files\",
"\\FS-GSU\GSU\files\",
"\\FSC09\IALC\files\",
"\\FILESERVER\<instance_name>\files\",
"\\fs-ihm\ihm\files\",
"\\fs-jccc\jccc\files\",
"\\fsc09\lccc\files\",
"\\fsc07\Mac\files\",
"\\fs-OUPTest\OUPTest\OUPScorm\files\",
"\\fsc08\OUPUAT\FILES\",
"\\fsc05\PASSHE\files\",
"\\fs-pct\PCT\files\",
"\\FSC08\Regis\files\",
"\\fsc08\SharedJ\files\",
"\\fs-sharedl\SharedL\files\",
"\\fsc09\tui\files\",
"\\fsc09\UWL_MOOC\files\",
"\\fsc07\WLU\files\",
"\\fsc09\uWaterloo\files\",
"\\FSC09\ADLC\files\",
"\\FSC09\BCOnline\files\",
"\\fs-cok\cok\files\",
"\\FSC09\EFT\files\",
"\\FSC09\EGTC\files\",
"\\FSC09\LCL\files\",
"\\fsc09\MACU\files\",
"\\FSC09\Marymount\files\",
"\\FSC09\McG\files\",
"\\FSC07\NMHU\files\",
"\\FSC09\Noodle\files\",
"\\FSC09\OCC\files\",
"\\fsc09\PIMA\files\",
"\\FSC08\sharedB\files\",
"\\FSC08\sharedG\files\",
"\\fs-sharedk\sharedk\files\",
"\\FSC09\Sheridan\files\",
"\\FSC09\SIU\files\",
"\\fs-uaf\uaf\files\",
"\\FSC09\UNB\files\",
"\\fsc07\USGTraining\files\",
"\\fsc09\UWinnipeg\files\",
"\\FSC08\WHRO\files\",
"\\FSC09\WHRO_State\files\",
"\\fsc09\wiu\files\",
"\\fsc07\4CD\files\",
"\\fsc09\ACL\files\",
"\\fsc09\adlctest\FILES\",
"\\FSC07\AOE\files\",
"\\FSC08\CBC\files\",
"\\FSC07\CICA\files\",
"\\fsc05789-bell\Community\files\",
"\\fsc09\Conestoga\files\",
"\\FSC08\DeSales\files\",
"\\FSC08\Durham\files\",
"\\fsc08\EIU\files\",
"\\fsc07\eLOTestDemo\files\",
"\\fsc07\FDLC\files\",
"\\FSC09\GADOE\files\",
"\\FSC07\GRU\files\",
"\\FSC07\HCL\files\",
"\\FSC08\HISD\files\",
"\\fsc07\hmhprod\files\",
"\\FSC09\IAL\files\",
"\\fsc07\iLearnNYC\files\",
"\\FSC08\InfiLaw\files\",
"\\fsc08\KishOnline\files\",
"\\FSC08\KNAER\files\",
"\\fsc07\LakeheadU\files\",
"\\FSC09\Langara\files\",
"\\fsc08\MarcJacobs\files\",
"\\fsc08\NEIU\files\",
"\\fsc07\NLU\files\",
"\\FSC07\NWFSC\FILES\",
"\\FSC09\OntarioSmartServe\files\",
"\\FSC09\ORU\files\",
"\\fsc08\OUP\files\",
"\\fsc09\Parkland\files\",
"\\FSC07\PearsonProd\files\",
"\\fsc07\PGprod\files\",
"\\FSC08\PilotProject01\files\",
"\\fsc07\rcl\files\",
"\\fsc08\Sandbox_C\files\",
"\\fsc08\SANOMAPRO\files\",
"\\fsc09\Sault\files\",
"\\FSC08\sharedA\FILES\",
"\\fsc07\sharedD\files\",
"\\fsc08\sharedF\files\",
"\\fsc08\sharedH\files\",
"\\fsc08\sharedP\files\",
"\\FSC08\SHOWCASE_C\files\",
"\\fsc08\uco\files\",
"\\FSC07\UManitoba\files\",
"\\fsc09\UMUC\files\",
"\\FSC09\UTEC\files\",
"\\FSC09\VIU\files\",
"\\fsc07\4CDTest\FILES\",
"\\FSC07\Accenture_Test\files\",
"\\fsc07\aoe_test\FILES\",
"\\fs-ASD20Test\ASD20Test\files\",
"\\fs-BCOnlineTest\BCOnlineTest\FILES\",
"\\fs-BJUTest\BJUTest\files\",
"\\fsc09\CBCTest\FILES\",
"\\fsc09\CencolAPM\FILES\",
"\\fs-CENCOLTEST\CENCOLTEST\files\",
"\\fsc07\CSULBTest\files\",
"\\fs-d2lcommtest\D2L_Community_Test\files\",
"\\fsc08\DurhamStaging\FILES\",
"\\fsc09\DurhamTest\FILES\",
"\\FSC09\EFMOOCQA\FILES\",
"\\FSC08\EFTDev\files\",
"\\fs-EGTC_Test\EGTC_Test\files\",
"\\fsc09\EIUTest\Files\",
"\\FSC07\FDLCTest\FILES\",
"\\fsc07\GADOETest\FILES\",
"\\fsc08\GSUDev\FILES\",
"\\fsc09\GSUTest\FILES\",
"\\FSC07\GwinnettTest\files\",
"\\fs-HACCTest\HACCTest\files\",
"\\fsc07\HBS_Sandbox\files\",
"\\FSC08\iLearnNYCStaging\files\",
"\\fs-iLearnNYCTest\iLearnNYCTest\files\",
"\\FSC07\InfiLawTest\FILES\",
"\\FSC07\LakeheadUTest\FILES\",
"\\FSC09\LANGARATest\FILES\",
"\\fs-LCCTest\LCCTest\FILES\",
"\\fs-LCLTest\LCLTest\files\",
"\\fsc07\LUTest\files\",
"\\FSC07\MacTest\files\",
"\\fsc09\McGTest\FILES\",
"\\fsc07\MCLTest\FILES\",
"\\fsc07\Mercy_Test\files\",
"\\fsc07\MWSUTEST\FILES\",
"\\fsc07\NAUTEST\files\",
"\\fsc07\NEIUTest\FILES\",
"\\fs-NJVS_Test\NJVS_Test\files\",
"\\FSC09\NMHUTest\files\",
"\\FSC09\NoodleTest\files\",
"\\FSC07\NWFSCTest\FILES\",
"\\fsc09\OCCTest\FILES\",
"\\fsc07\ool_guelphtest\files\",
"\\FSC09\ORUTest\files\",
"\\fsc07\OUHSCTest\files\",
"\\FSC08\OUPDev\files\",
"\\fs-OUPTest\OUPTest\files\",
"\\fsc07\ParklandTest\files\",
"\\fsc07\PASSHETest\files\",
"\\fsc07\PCCDTest\files\",
"\\T1IS01\PearsonDev\files\",
"\\fsc07\PearsonDev2\FILES\",
"\\HQPD03\PearsonQA\FILES\",
"\\fsc07\PGTest\FILES\",
"\\fs-PIMATest\PIMATest\files\",
"\\fs-PJETest\PJETest\files\",
"\\FSC07\PortlandTest\files\",
"\\FSC07\Radford_Test\files\",
"\\fsc09\RegisTest\FILES\",
"\\FSC07\SAITTest\files\",
"\\fs-sandbox_b_test\sandbox_b_test\files\",
"\\T1WEB88A-Test\Sandbox_S_Test\files\",
"\\fsc09\SANOMAPROTest\FILES\",
"\\fsc08\sharedBt\files\",
"\\FSC08\sharedDt\FILES\",
"\\fsc07\SheridanDev\FILES\",
"\\FSC09\SheridanQA\FILES\",
"\\fs-SIUTest\SIUTest\files\",
"\\fsc08\SouthCarolinaDev\FILES\",
"\\fs-TAMUKTEST\TAMUKTEST\files\",
"\\FILESERVER\<instance_name>\files\",
"\\FSC08\UCBDev\files\",
"\\FS-UCBTEST\UCBTest\FILES\",
"\\fsc09\UCOTest\FILES\",
"\\fsc09\UManitobaTest\FILES\",
"\\fsc07\UMUCDev\files\",
"\\FSC09\UNBTest\files\",
"\\FSC09\UTECTest\FILES\",
"\\fsc09\uwaterloodev\files\",
"\\fs-UWaterlooTest\UWaterlooTest\files\",
"\\FSC09\UWinnipegTest\FILES\",
"\\FSC07\VIUTest\FILES\",
"\\FSC07\WalshTest\files\",
"\\FSC09\WHRO_State_Test\files\",
"\\FSC07\WHRO_Test\files\",
"\\fs-WIUTest\WIUTest\FILES\",
"\\fsc07\WLUTest\files\"
)
#endregion

#region Variables
$tempFile = "hellothere3141592653589.txt"
$tempTime = Get-Date
$fileCreated = $false
$index = 0
#endregion

#clear the screen
Clear

#loop through all the folders
while ($index -lt $folders.Count)
{
	#see if the path even makes sense (i.e. would it even be allowed to exist)
	if (Test-Path ($folders[$index]) -IsValid)
	{
		try 
		{ 	
			$fileCreated = $false
			$tempTime = Get-Date
			#try to create the file
			New-Item ($folders[$index] + $tempFile) -type file -Force:$true 2> $null > $null
			#the file now exists
			if (Test-Path ($folders[$index] + $tempFile))
			{
				$tempTime = (Get-Date) - $tempTime
				Write-Host ("File created," + $instances[$index] + "," + $folders[$index] + "," + $tempTime.TotalMilliseconds)
				$fileCreated = $true
			}
			#the file didn't get created
			else { Write-Host ("Failed to create file," + $instances[$index] + "," + $folders[$index]) }
	
			#the file was created - try to delete it
			if ($fileCreated)
			{
				try
				{
					$tempTime = Get-Date
					#try to delete the file
					Remove-Item ($folders[$index] + $tempFile) -Force:$true 2> $null > $null
					#the file still exists - bad
					if (Test-Path ($folders[$index] + $tempFile)) { Write-Host ("Failed to delete file," + $instances[$index] + "," + $folders[$index] + $tempFile) }
					#the file does not exist - good
					else
					{
						$tempTime = (Get-Date) - $tempTime
						Write-Host ("File deleted," + $instances[$index] + "," + $folders[$index] + "," + $tempTime)
					}
				}
				#no good
				catch { Write-Host ("Failed to delete file," + $instances[$index] + "," + $folders[$index] + $tempFile) }
			}
		}
		#no good
		catch { Write-Host ("Failed to create file," + $instances[$index] + "," + $folders[$index]) }
	}
	#no good
	else { Write-Host ("Path is not valid," + $instances[$index] + "," + $folders[$index]) }
	#increase the index
	$index++
}